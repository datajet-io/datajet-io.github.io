var escapeRegEx=function(){return{escapeRegExChars:function(a){return a.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&")},isNumber:function(a){return"number"===typeof a},isUndefined:function(a){return"undefined"===typeof a},noop:function(){}}}();var PersistentStorage=function(){function a(a){this.prefix=["__",a,"__"].join("");this.ttlKey="__ttl__";this.keyMatcher=new RegExp("^"+escapeRegEx.escapeRegExChars(this.prefix))}function c(a){return JSON.stringify(escapeRegEx.isUndefined(a)?null:a)}var b;try{b=window.localStorage,b.setItem("~~~","!"),b.removeItem("~~~")}catch(e){b=null}b&&window.JSON?(a.prototype._prefix=function(a){return this.prefix+a},a.prototype._ttlKey=function(a){return this._prefix(a)+this.ttlKey},a.prototype.get=function(a){this.isExpired(a)&&
this.remove(a);a=b.getItem(this._prefix(a));return JSON.parse(a)},a.prototype.set=function(a,f,d){escapeRegEx.isNumber(d)?b.setItem(this._ttlKey(a),c((new Date).getTime()+d)):b.removeItem(this._ttlKey(a));return b.setItem(this._prefix(a),c(f))},a.prototype.remove=function(a){b.removeItem(this._ttlKey(a));b.removeItem(this._prefix(a));return this},a.prototype.clear=function(){var a,c,d=[],g=b.length;for(a=0;a<g;a++)(c=b.key(a)).match(this.keyMatcher)&&d.push(c.replace(this.keyMatcher,""));for(a=d.length;a--;)this.remove(d[a]);
return this},a.prototype.isExpired=function(a){a=b.getItem(this._ttlKey(a));a=JSON.parse(a);return escapeRegEx.isNumber(a)&&(new Date).getTime()>a?!0:!1}):(a.prototype.get=escapeRegEx.noop,a.prototype.set=escapeRegEx.noop,a.prototype.remove=escapeRegEx.noop,a.prototype.clear=escapeRegEx.noop,a.prototype.isExpired=escapeRegEx.noop);return a}();var Datajet=Datajet||{};Datajet._hostOverride=null;Datajet._suggestUrl="/1.1/suggest/%QUERY";Datajet._prefetchUrl="/1.1/prefetch/";Datajet._queryLimit=50;Datajet._getUrl=function(a,c,b){return"http://$host$ep?key=".replace("$host",a).replace("$ep",c)+b+"&size="+Datajet._queryLimit};Datajet.euw=function(a){return new Datajet.Seer("euw",a)};Datajet.usw=function(a){return new Datajet.Seer("usw",a)};Datajet.apse=function(a){return new Datajet.Seer("apse",a)};
Datajet.sae=function(a){return new Datajet.Seer("sae",a)};Datajet.Seer=function(a,c){var b="seer$region$datajet.io".replace("$region$",""!==a?"."+a+".":"."),b=null==Datajet._hostOverride?b:Datajet._hostOverride;this.seerUrl=Datajet._getUrl(b,Datajet._suggestUrl,c);this.prefetchUrl=Datajet._getUrl(b,Datajet._prefetchUrl,c);this.ttl=6E5;this._requestor=window.XMLHttpRequest?new XMLHttpRequest:new ActiveXObject("Microsoft.XMLHTTP");this.storage=new PersistentStorage(this.prefetchUrl);this.initialize()};
Datajet.Seer.prototype.initialize=function(){var a=this.storage,c=this.ttl;this._ajax(this.prefetchUrl,function(b){if(null!=b)for(var e in b)a.set(e,b[e],c)})};Datajet.Seer.prototype.ajaxError=function(a){console.log("Datajet ERROR XMLHttpRequest status: "+a.status)};
Datajet.Seer.prototype._ajax=function(a,c){var b=this;this._requestor.onreadystatechange=function(){4==b._requestor.readyState&&(200==b._requestor.status?c(JSON.parse(b._requestor.responseText)):b.ajaxError(b._requestor))};this._requestor.open("GET",a,!0);this._requestor.withCredentials=!0;this._requestor.send()};
Datajet.Seer.prototype.get=function(a,c){if(""==a)c([]);else{var b=this.storage,e=this.ttl,f=this.storage.get(a);null!=f?c(f):this._ajax(this.seerUrl.replace("%QUERY",a),function(d){null===d&&(d=[]);b.set(a,d,e);c(d)})}};